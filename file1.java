First 100 lines of the code.
modified by master
